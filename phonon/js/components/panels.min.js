!function(e,t,n,i){"use strict";function a(){var e=t.querySelector(".app-active");if(null!==e.querySelector("div.backdrop-panel")){var i=l[l.length-1].backdrop;i.classList.remove("fadeout"),e.removeChild(i)}l[l.length-1].panel.style.visibility="visible",c=!1,l.pop(),this.off(n.event.transitionEnd,a,!1)}function r(e){if(!c&&(e.style.visibility="visible",!e.classList.contains("active"))){e.classList.add("active");var n=n=s();t.querySelector(".app-active").appendChild(n),l.push({panel:e,backdrop:n})}}function o(e){if(!c&&e.classList.contains("active")&&!c){c=!0,e.classList.remove("active"),e.classList.add("panel-closing");var t=function(){e.classList.remove("panel-closing"),e.off(n.event.transitionEnd,t)};if(e.on(n.event.transitionEnd,t),l.length>0){var i=l[l.length-1].backdrop;i.classList.add("fadeout"),i.on(n.event.transitionEnd,a,!1)}}}var l=[],c=!1,s=function(){var e=t.createElement("div");return e.classList.add("backdrop-panel"),e},f=function(e){for(var n,i=t.querySelectorAll("[data-panel-id], [data-panel-close]");e&&e!==t;e=e.parentNode)for(n=i.length;n--;)if(i[n]===e)return e},d=function(e){var n=f(e.target);if(n){var i=n.getAttribute("data-panel-id");return i?t.querySelector("#"+i):p(e.target)}},p=function(e){for(var n,i=t.querySelectorAll(".panel, .panel-full");e&&e!==t;e=e.parentNode)for(n=i.length;n--;)if(i[n]===e&&e.classList.contains("active"))return e};t.on(n.event.start,function(e){if(e=e.originalEvent||e,l.length>0){var t=l[l.length-1].panel,n=p(e.target);n||o(t),n&&n!==t&&n.id!==t.id&&o(t)}}),t.on(n.event.tap,function(e){var t=f(e.target),n=null;if(t&&(n=d(e),n&&(n.classList.contains("active")?o(n):r(n))),n=p(e.target),!n&&!t&&l.length>0){var i=l[l.length-1].panel;p(e.target);o(i)}}),n.panel=function(e){if("undefined"==typeof e)return{closeActive:function(){var e=l.length>0?!0:!1;return e&&o(l[l.length-1].panel),e}};var n="string"==typeof e?t.querySelector(e):e;if(null===n)throw new Error("The panel with ID "+e+" does not exist");return{open:function(){r(n)},close:function(){o(n)}}},e.phonon=n,"object"==typeof exports?module.exports=n.panel:"function"==typeof define&&define.amd&&define(function(){return n.panel})}(window,document,window.phonon||{});